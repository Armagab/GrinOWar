# GrinOWar

## Описание
GrinOWar — Telegram-бот для ежедневного выбора начального фрагмента шутки (промпта) и сбора пользовательских продолжений. После сбора всех шуток проводится голосование, по результатам которого определяется топ-5 лучших.

## Основные возможности

- **Выбор промпта**: автоматический генератор или пользовательские предложения через команду «Предложить заготовку».  
- **Приём шуток**: отправка или обновление шутки на основе промпта; при обновлении текст перезаписывается, а статистика сбрасывается.  
- **Модерация**: проверка текстов на соответствие правилам с помощью OpenAI API.  
- **Голосование**: вывод до 50 шуток рандомно, по 5 на страницу; учёт просмотров и лайков.  
- **Рассылка**: ежедневно в 12:00 (МСК) бот считает результаты, сохраняет победителей и рассылает топ-5 с новым промптом активным пользователям.  
- **Администрирование**: команды `/forceprompt` и `/forceroutine` для ручного запуска выбора промпта и ежедневной рутины.

- # Структура проекта

```text
src/
├── bot.py                  # инициализация и запуск бота
├── config.py               # загрузка настроек и констант
├── handlers/               # обработчики команд и коллбеков
│   ├── admin.py
│   ├── profile.py
│   ├── prompt.py
│   ├── start.py
│   ├── suggest.py
│   └── vote.py
├── services/               # бизнес-логика
│   ├── daily_routine.py
│   ├── prompt_manager.py
│   ├── results_storage.py
│   ├── scheduler.py
│   └── scoring.py
├── database/               # работа с SQLite через aiosqlite
│   ├── joke_queries.py
│   ├── prompt_queries.py
│   └── user_queries.py
├── keyboards/              # формирование клавиатур
│   ├── confirm_replace.py
│   ├── main_menu_keyboard.py
│   ├── start_buttons.py
│   └── voting_buttons.py
├── middlewares/            # обновление last_active
│   └── last_active.py
├── states/                 # FSM-состояния
│   └── bot_states.py
└── utils/                  # утилиты: форматирование, валидация, модерация
    ├── formatters.py
    ├── moderation.py
    ├── reply_lines.py
    └── validators.py
